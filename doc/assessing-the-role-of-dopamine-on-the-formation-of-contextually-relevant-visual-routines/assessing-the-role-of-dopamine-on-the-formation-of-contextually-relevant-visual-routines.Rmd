---
title: Assessing the influence of dopamine and mindfulness on the formation of task-relevant eye-movement patterns
authors:
  - name: Kelly G. Garner
    department: School of Psychology
    affiliation: University of New South Wales
    location: Sydney, NSW
    email: insert.unsw@here.edu.au
  - name: Li-Ann Leow
    department: School of Psychology
    affiliation: The University of Queensland
    location: St. Lucia, QLD
  - name: Aya Uchida
    department: School of Psychology
    affiliation: The University of Queensland
    location: St. Lucia, QLD
  - name: Ole Jensen
    department: Center for Human Brain Health
    affiliation: University of Birmingham
    location: Birmingham, UK
  - name: Marta Garrido
    department: School of Psychological Sciences
    affiliation: University of Melbourne
    location: Melbourne, VIC
  - name: Paul  E. Dux
    department: School of Psychology
    affiliation: The University of Queensland
    location: St. Lucia, QLD
abstract: |
  Enter the text of your abstract here.
keywords:
  - blah
  - blee
  - bloo
  - these are optional and can be removed
bibliography: references.bib
biblio-style: unsrt
output: rticles::arxiv_article
---

```{r knitr_options, echo=FALSE}
library(knitr)
library(brms)
library(tidyverse)
# rstudio will set the folder where .Rmd file seats as work directory
# set it back to the folder where .Rproj seats
#opts_knit$set(root.dir = normalizePath("../")) 
opts_chunk$set(fig.align = 'center', cache = FALSE, warning = FALSE,
  message = TRUE, echo = FALSE)
options(digits = 3, width = 88, knitr.graphics.auto_pdf = TRUE,
        knitr.kable.NA = '')
# knit_hooks$set(inline = function(x) {
#   x <- sprintf("%1.2f", x)
#   paste(x, collapse = ", ")
# })
```

# Introduction

JoN - 600 words
Here goes an introduction text

Overview:
3. we learn to deploy sets of task-relevant behaviours in stereotyped ways. (I think the narrative will go 3 -> 2 -> 1).
2. we must keep task-relevant behaviours contexually appropriate, even though they may be easily confusable.
1. we must use experience to learn task-relevant behaviours

_Dopamine_
- obviously important - reinforces successful behaviours to increase their future probability in the same state - i.e. learning. - need to consider 
- also important for 2 - songbirds (see papers below)
see https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7430502/ for setting in humans - but no consideration of the balance of habit (stereotypy) and context.
- also important for 3 - see Deschroers et al work. - but less consideration of confusion
  - also here - tonic dopamine may drive the acquaition of stereotypical/habitual responding in a desire to speed up action and attain more reward - https://nyaspubs.onlinelibrary.wiley.com/doi/abs/10.1196/annals.1390.018?casa_token=hvk9kHF_wFwAAAAA:2ykcybgrRv20LzpzcorTYQ_7y18v_ZRN92l9fYxmhh2-pf58FDxzJjDj5ZmNejMVVXVPmMbGJ3Tv7tALXw
- add successor representation/RL here? - but no active manipulation of dopamine

_Mindfulness_
- Ability to stay on task has been linked to mindfulness - e.g. wandering away from task set to focus on something else - whether it relates to context mixing remains to be determined.
https://www.sciencedirect.com/science/article/pii/S2352250X18301714?casa_token=flMXMBk7zNUAAAAA:i0XTu9MN85Cn92T7OINd7ghsx7sQMzsYZcaQGmMlFWMJjb-IXZZHBVUYjYYL7wTixQ33D3w-hoEg
https://www.sciencedirect.com/science/article/pii/S0005791622000994
Theory that mindfulness contributes to flexibility in behaviour - i.e. not becoming too rigid https://www.sciencedirect.com/science/article/pii/S1697260023000170
- mindfulness - relates to mindwandering eye-movements (number of) - https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0210862
_Tying them together_
The two may interact to influence these phenomena. 
https://www.frontiersin.org/articles/10.3389/fpsyg.2015.00090/full

_Aims_
1. Develop a paradigm that allows us to observe the phemomena of interest
2. Test the impact of dopamine and trait mindfulness on these phenomena
3. 


# Methods
\label{sec:Methods}

## Participants

A total of 40 participants (mean age: 24.5, sd: 5, 30 female, 10 male) were recruited using the undergraduate and paid SONA pools administered by the University of Queensland. All procedures were cleared by the University of Queensland Human Research ethics committee [2017/HE000847], and were conducted in accordance with the National Statement on Ethical Conduct in Human Research. Participants were over 18 years old, had no known neurological and psychiatric conditions (assessed by self report), and no contraindications to Levodopa, as assessed by the Levodopa safety screening questionnaire. Informed consent was obtained at the start of the first session. 

## Procedure

Participants attended two sessions, spaced approximately 1 week apart. After initial blood pressure (BP) and mood assessments [@bondUseAnalogueScales1974], participants received either placebo (vitamin C) or Levodopa (Madopar 125: 100 mg Levodopa and 25 mg Benserazide Hydrochloride), crushed and dispersed in orange juice, now referred to as the 'placebo' and 'DA' sessions respectively. The solution was prepared by an experimenter who did not administer the remaining experimental procedures. This protocol was sufficient to achieve double blinding in previous work [@chowdhuryDopamineModulatesEpisodic2012; @chowdhuryDopamineRestoresReward2013]. Participants then completed the Five Facet Mindfulness Questionnaire [@baerUsingSelfReportAssessment2006] and the Barratt Impulsivity Scale [BIS; @pattonFactorStructureBarratt1995], as trait impulsivity scores are associated with midbrain dopamine D2/D3 receptor availability. Around 30 minutes after drug administration, participants completed a second BP and mood rating assessment. Participants then completed the practice stage of the task, so that the experimental stage began approximately 40 minutes after drug ingestion, within the window of peak plasma availability. At the end of the session, participants completed the final BP and mood rating assessment and were asked whether they thought they had been given the active or placebo drug.

## Apparatus

The experimental task was run with custom code^[https://github.com/kel-github/variability-decision-making], written using Matlab 2012b (32 bit) and Psychtoolbox v3.0.14, on a Windows 7 (64-bit) on a Dell Precision T1700 desktop computer, displayed using a ASUS VG248 monitor. Gaze coordinates (x, y) were sampled at 120 Hz using a monitor-mounted iView Red-m infrared eye tracker (SensoMotoric Instruments GmbH, Teltow, Germany). Participants were seated from the monitor at an approximate viewing distance of 57 cm, and positioned on a chin-rest for the duration of the task.

## Experimental Task

Each trial began with a fixation dot presented centrally on a grey screen [RGB: 200 200 200]. Participants were instructed to fixate on the dot to begin a trial. After 1000 ms of continuous correct fixation samples (within 100 pixels of fixation), a square was presented that comprsed 18° of degree visual angle along each length. The square could be one of four possible colours [RGBs: 87, 208, 169; 267, 145, 52; 167, 162, 229; 239, 91, 158]. After 1000 ms, a 4 x 4 grid of smaller squares appeared within the larger square, in a darker version of the background colour ([RGB]-50). Each square comprised 2.6° of visual angle. Participants were instructed that the 4 x 4 grid represented doors, and that they were to use their eyes to open the doors to find where the target was hiding. Participants were also instructed that they were to fixate on a single door to open it. When participants had fixated on a single door for over 300 ms, the door either turned black [RGB: 50, 50, 50], to denote the absence of a target, or the target was displayed and the trial was terminated. If the door had turned black, it returned to its previous colour as soon as it was detected that the participant had moved their eyes from the door. Targets were animal images drawn randomly on each trial from a pool of 100 images taken from the internet. The time at which the target was available to be found varied from trial to trial, with the onset being drawn from a uniform distribution between 500-2000 ms. Once the target was available and the correct door selected, the target was displayed for 750 ms. Upon termination of the trial, the grey screen and white fixation cross were presented (see Fig \ref{fig:taskFig}A).

In each session, participants were shown two possible background and door colour sets. Participants were instructed that each colour represented a world, and that the animals had different places they preferred to hide, depending on the world they were in. There were four possible target locations within each world, or from here on, visual context. For each visual context, 1 door from each quadrant was selected as one of the 4 target locations where the targets could appear (see Fig \ref{fig:taskFig}B), with the constraint that target locations could not overlap between contexts. Thus each colour reflected a context in which participants could establish a set of task-relevant eye-movements, i.e. towards the 4 possible target locations for that context. Note that within each context, the target was equally likely to appear behind any one of the 4 target doors (p=.25) and would never appear behind the remaining doors (p=0). Colour-target location mappings were counterbalanced across participants, as was the assignment of coloured contexts to sessions. Participants completed 80 trials in each context. Eye-movement calibration and validation was performed every 20 trials. Participants were also shown the standard QWERTY keyboard and were instructed that they could press ‘x’ at any time to perform a new calibration and validation if they felt that their eye-movements were no longer being registered accurately; i.e. if they were unable to open doors even though they were selecting them.

```{r taskfig, out.width='70%', fig.cap='Experimental Task. A) A single trial where participants use their eyes to open doors to locate a target. B) Contexts and sessions: in each session, participants are exposed to two colour contexts each with 4 unique and equiprobable target locations. Colours and target locations were counterbalanced across participants and sessions. In each session, Levodopa (DA) or placebo is administered under double blind conditions.'}

taskfigpth <- '../../images/DA_ExpTask.pdf'
knitr::include_graphics(taskfigpth)

```


## Statistical Approach

The analysis was designed to assess the learning of the target locations given the context, the extent to which eye-movements became stereotypical, and how both of these measures were modulated by the dopamine and mindfulness factors. All custom analysis code is available online^[insert link]. The analysis was performed using R and RStudio v2022.07.2 [@rstudiocitation], and can be reproduced in the Neurodesk container environment [@rentonNeurodeskAccessibleFlexible2022].

### Data cleaning

```{r, echo=FALSE, warning=FALSE}
# get the number of participants who would have been excluded if we'd gone with the original criteria
load('../../data/derivatives/accuracy.Rda')
n_potential_exclude <- length(unique(door_acc_sum$sub[door_acc_sum$excl == 1]))
```

Doors were marked as selected if participants gazed at them for a duration of at least 300 ms. We assumed that a door could not be selected twice consecutively, and collapsed any consecutive selections into a single door selection. Last, as the final door selection of every trial was fixed (i.e. finding the target location ends the trial), we removed the final selection from each trial for the sequence analysis defined below. We excluded data from one participant whose total number of door selections was greater than 3 standard deviations from the mean across both sessions. The remaining 39 datasets were retained for all of the analyses. Note that this is more inclusive than our pre-registered plan for data exclusions^[https://osf.io/2y6pk]. Based on pilot data, we had planned to exclude participants who scored < 65% accuracy over the course of a session. Analysis of the final sample suggested that this was too stringent, as this resulted in the exclusion of `r sprintf("%d", n_potential_exclude)` of 40 participants. 

## Accuracy

We first sought to determine the extent to which participants learned the target locations, and then whether participants learned to select the doors that were relevant given the current context. Door selections were classified as target relevant (TR) for the current context (cc), the other context from that session (oc), or neither (n). Data was then grouped into blocks of 10 trials per context, and grouped across contexts, resulting in 8 blocks of 20 trials. First, to determine whether participants learned the target locations, regardless of context, we computed accuracy as the number of times participants selected a target door (referred to from now as accuracy [acc]), relative to all door selections:

$$
acc = \frac{\sum{(TR_{cc}, TR_{oc})}}{\sum{(TR_{cc}, TR_{oc}, n)}}
$$

We assessed the influence of block, drug and mindfulness on accuracy using a Bayesian mixed model approach. Accuracy was assumed to be drawn from a binomial distribution (1=target door, 0 = non-target door). The probability of drawing a target-door from the total number of door selections made by a given participant was modelled logistic regression. Note that as we use logistic regression, resulting regression parameter values reflect changes to the log-odds of target door selections.

For this and following analyses, we found the model that best fit the data, and made inference over the resulting parameters. We report the 95% confidence intervals (CIs) of the parameter posteriors, and assume we have detected a reliable effect when the 95% CIs of the posterior do not include zero. Models were fit using the BRMS [@burknerBrmsPackageBayesian2017] interface for Stan [@standevelopmentteamStanModelingLanguage] and RStan [@standevelopmentteamRStanInterfaceStan2023]. We used the default weakly informative priors as specified in [@burknerBrmsPackageBayesian2017]. Specifically, fixed and random effect $\beta$ coefficients were given a flat prior, intercept and standard deviations were assumed to be drawn from a student's $t$ distribution (df=1, location=0, scale=2.5), and the LKJ-correlation prior with parameter $\zeta$ > 0 was used for the parameter covariance matrix. For each model, we checked for parameter recovery using simulated data. Once fitted, we checked that the residuals showed no signs of systematic error, that the chains had converged, and that $\hat{R}$ values were less than 1.01. 

To eschew an overly large model space, and in line with our pre-registration, we first fit models that contained each possible combination of the block and drug regressors (and associated random effects), and found the best model using leave-one-out (LOO) cross validation [as implemented in @vehtariPracticalBayesianModel2017]. (Note that in the pre-registration document we had proposed to compare models using the deviance information criterion (DIC). As LOO is more robust than DIC to influential observations, and is readily implemented for use with BRMS model objects, we opted to use LOO instead of DIC). Upon identifying the best model, we then added the mindfulness regressor using all possible combinations, and once again selected the best model (as evidenced by LOO). Last we controlled for trait impulsivity by adding BIS scores as a main effect to the winning model. Note that in no cases did adding BIS scores improve the model. We report the difference in the expected log posterior density (ELPD) between the next best models and the winning model, and the ratio of the ELPD difference to the standard error (SE) of the difference (ELPD:SE), thus a negative ELPD difference reflects preference for the winning model. The full set of model comparisons are presented in the supplementary materials. 

## Contextual Accuracy

We next sought to understand whether dopamine modulates the ability of participants to select the correct door, given the context. Therefore, for each context, we computed the total number of cc door selections (c-acc), and modelled the probability of attaining c-acc given the total number of correct door selections:

$$
c\mathrm{-}acc = \frac{\sum{TR_{cc}}}{\sum{(TR_{cc}, TR_{oc})}}
$$

We then modelled this data using the Bayesian mixed effects approach described above (Note that in the pre-registration document we had suggested to include a regressor for context. Visual inspection of the data showed that c-acc was highly comparable across contexts [see supplemental figures]. We therefore opted to simplify the model space and collapse over this factor). 

## Stereotypical door selections

Next, we determined the extent to which door-selection patterns increased in stereotypy over the course of the task, and whether dopamine and mindfulness modulates the extent of stereotypy. Here we define stereotypy as sets of door selections being deployed in the same order, over trials [e.g. @desrochersHabitLearningNaive2015]. Therefore we wish to know whether, given the doors that a participant chose to open over the trials of the experiment, does their data suggest that they are selecting them in a more regularised manner as the experiment progresses? 

In order to characterise the extent to which door selections increased in stereotypy, we reasoned that stereotypy should be evidenced by an increase in the probability of a subset of door selection transitions, at the expense of others. This stands in contrast to when making door selections in an exploratory, or non-stereotyped way, where a greater number of door transitions should show comparable probabilities. Therefore, the transition probability matrices of individuals engaged in more stereotypical door selections should show higher variance than those who are not engaging in stereotypical door selections. We therefore computed trial level transition probability matrices, and computed the variance of each matrix. Variances were then collapsed across context and trials to form a variance score for each participant, session and block.

```{r, check_priors_var_model, echo=FALSE, warning=FALSE}

load('../../data/derivatives/stereo_winplusmind_dmindint/stereo_winplusmind_dmindint.Rda')
rm(mndbd_dm)
```

The resulting variance scores were subject to a comparable Bayesian mixture modelling approach as described above with a few key differences; the variance scores were assumed to be drawn from a skewed normal distribution $\mathcal{N}(\mu, \sigma, \alpha)$ whose mean ($\mu$) was defined by the regression parameters (the distribution of variance scores can be found in the supplemental materials). $\sigma$ was assumed to be drawn from a Student's t distribution (df=3, location=0, scale=2.5), the skew parameter ($\alpha$) was assumed to be drawn from a normal distribution $\mathcal{N}(0,4)$. The remaining priors for the intercept, beta-coefficients and parameter covariance matrix were defined in the same manner as for the accuracy data models. As the log-log plot of variances vs block suggested a power function, analysis was performed on the logged data. This ensured that the relationship between block and variance values was best described by a straight line. Identification of the winning model proceeded as described for the accuracy data above. 

## Blinding analyses

To determine whether awareness of the dopamine intervention could have contributed to the findings, the probability of participant ratings were compared to the expected values assuming chance guessing, using a Chi Square test. BP and mood ratings were each subject to a session (DA vs placebo) x timepoint (pre-drug, pre-experiment, post-experiment) Bayesian repeated measures ANOVA, implemented using the BayesFactor package for R [@moreyBayesFactorComputationBayes2015] using the default priors [@rouderDefaultBayesFactors2012].

# Results

Overall, mindfulness and DA interacted to show opposing effects on accuracy and stereotypy, whereas only DA modulated contextual accuracy.

## Accuracy 

```{r, load_acc_mod_comps, echo = FALSE, warning = FALSE, message=FALSE, results = FALSE}

load('../../data/derivatives/acc_loo.Rda')
load('../../data/derivatives/acc_mind_loo.Rda')
load('../../data/derivatives/acc_mind_bis_comp.Rda')
load('../../data/derivatives/acc_winplusmindbdmnd/acc_winplusmindbdmnd.Rda')
acc_results <- print(mndbdrg3way, digits = 2)

```

### Model Selection

First we sought the model with the greatest predictive accuracy so that we could make subsequent inference over the parameters. The model that best accounted for the experimental factors contained main fixed effects of block and drug, and random effects for block x drug. Although this model was only closely preferred to the next most complex model that contained a block x drug interaction (ELPD diff = `r sprintf("%1.2f", acc_comp["fxbdrgint_bdrgsubrfx", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", acc_comp["fxbdrgint_bdrgsubrfx", "elpd_diff"]/acc_comp["fxbdrgint_bdrgsubrfx", "se_diff"])`), it was strongly preferred to all other models (min ELPD diff = `r sprintf("%1.2f", acc_comp["fxbdrg_bsubrfx", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", acc_comp["fxbdrg_bsubrfx", "elpd_diff"]/acc_comp["fxbdrg_bsubrfx", "se_diff"])`). Adding mindfulness scores improved the predictive accuracy of the model; the winning model contained an additional main effect of mindfulness, two-way interactions with block and with drug, and a 3-way block x drug x mindfulness interaction (ELPD diff = `r sprintf("%1.2f", acc_mind_comp["fxbdrg_rfxbdrg", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", acc_mind_comp["fxbdrg_rfxbdrg", "elpd_diff"]/acc_mind_comp["fxbdrg_rfxbdrg", "se_diff"])`). Adding BIS scores did not improve the predictive value of the model (ELPD diff = `r sprintf("%1.2f", acc_mind_bis_comp["acc_mindwin_bis", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", acc_mind_bis_comp["acc_mindwin_bis", "elpd_diff"]/acc_mind_bis_comp["acc_mindwin_bis", "se_diff"])`). Note that although we draw inferences over parameters from the winning model, our inferences are the same as if we had used the more complex model that includes the BIS scores.


### The effect of drug and mindfulness on accuracy

```{r, acc_descriptives, echo = FALSE, warning = FALSE, message=FALSE, results = FALSE}
## Here I grab the summary stats saved in the plotting file
load("../../data/derivatives/acc_descriptives.Rda")

overall_acc_by_drug <- mu_bdrug_pred %>% group_by(drug) %>% 
                          summarise(mu = mean(p), ci=mean(ci)) %>%
                          mutate(lower = mu-ci,
                                 upper = mu+ci)

# summarise mindfulness interaction
qs <- with(mnddrgi, quantile(m.x, c(0.25, 0.75)))
sum_dat$qs <- 0
sum_dat$qs[sum_dat$m.x < qs[1]] <- 1
sum_dat$qs[sum_dat$m.x > qs[2]] <- 2
sum_dat$qs <- as.factor(sum_dat$qs)

qs_sum <- Rmisc::summarySEwithin(data=sum_dat, measurevar="p",
                                          withinvars=c("drug", "qs"),
                                          idvar="sub")
qs_sum <- qs_sum %>% mutate(lower=p-ci, upper=p+ci)

# summarise block 1 vs block 8
b_dat <- Rmisc::summarySEwithin(data=sum_dat, measurevar = "p",
                                withinvars="b.x",
                                idvar="sub")
b_dat <- b_dat %>% mutate(upper=p+ci, lower=p-ci)

acc_dat_4_correlation_w_stereo <- sum_dat %>% group_by(sub) %>% summarise(mu_acc = mean(obs))
tmp <- sum_dat %>% group_by(sub, drug) %>% summarise(mu_acc = mean(obs)) %>% 
                          group_by(sub) %>% summarise(delta = mu_acc[drug == "levodopa"] -
                                                              mu_acc[drug == "placebo"]) 
acc_dat_4_correlation_w_stereo <- inner_join(acc_dat_4_correlation_w_stereo, tmp)
```

Having established the best model to account for the data, we next determine the influence of DA and mindfulness on accuracy by making inference over the resulting parameters. Accuracy data plotted by block x drug session (DA va placebo) are shown in Fig \ref{fig:accfig}A. Critically, the influence of drug on accuracy was impacted by mindfulness scores. The drug x mindfulness parameter differed reliably from zero (mean log odds = `r sprintf("%1.2f", acc_results$fixed["drugplacebo:m","Estimate"])`, 95% CI[`r sprintf("%1.2f", acc_results$fixed["drugplacebo:m","l-95% CI"])`, `r sprintf("%1.2f", acc_results$fixed["drugplacebo:m","u-95% CI"])`], see Fig \ref{fig:accfig}E). To better understand this interaction, we computed a score for each participant that reflected the mean accuracy change due to the drug session ($\mu$ acc[DA - P]). Note that a positive score indicates that performance was better in the DA session relative to placebo. Next we examined the relationship between drug-induced accuracy changes and mindfulness scores. As can be seen in Fig \ref{fig:accfig}B, there was a positive relationship between drug-induced accuracy changes and mindfulness; participants scoring higher for mindfulness showed higher accuracy for the DA relative to the placebo session, for example, those scoring in the highest quartile showed mean accuracy scores of `r sprintf("%1.2f", qs_sum$p[qs_sum$drug == "levodopa" & qs_sum$qs == "2"])` (95%CI[`r sprintf("%1.2f", qs_sum$lower[qs_sum$drug == "levodopa" & qs_sum$qs == "2"])`, `r sprintf("%1.2f", qs_sum$upper[qs_sum$drug == "levodopa" & qs_sum$qs == "2"])`]) during the DA session, relative to mean accuracy scores of `r sprintf("%1.2f", qs_sum$p[qs_sum$drug == "placebo" & qs_sum$qs == "2"])` (95% CI[`r sprintf("%1.2f", qs_sum$lower[qs_sum$drug == "placebo" & qs_sum$qs == "2"])`, `r sprintf("%1.2f", qs_sum$upper[qs_sum$drug == "placebo" & qs_sum$qs == "2"])`]) during the placebo session. Individuals scoring low on mindfulness showed the opposite pattern (DA mean accuracy = `r sprintf("%1.2f", qs_sum$p[qs_sum$drug == "levodopa" & qs_sum$qs == "1"])`, 95% CI[`r sprintf("%1.2f", qs_sum$lower[qs_sum$drug == "levodopa" & qs_sum$qs == "1"])`, `r sprintf("%1.2f", qs_sum$upper[qs_sum$drug == "levodopa" & qs_sum$qs == "1"])`], placebo mean accuracy = `r sprintf("%1.2f", qs_sum$p[qs_sum$drug == "placebo" & qs_sum$qs == "1"])`, 95%CI[`r sprintf("%1.2f", qs_sum$lower[qs_sum$drug == "placebo" & qs_sum$qs == "1"])`, `r sprintf("%1.2f", qs_sum$upper[qs_sum$drug == "placebo" & qs_sum$qs == "1"])`]), note that Fig \ref{fig:accfig}B shows the difference between these accuracy scores). Thus the impact of DA on the establishment of task-relevant eye-movements is dependent on the mindfulness state of the individual.

Participants learned the target door locations over the course of the sessions, accuracy reliably increased over blocks. Mean accuracy in block 1 was `r sprintf("%1.2f", b_dat$p[b_dat$b.x == "0"])` (95% CI[`r sprintf("%1.2f", b_dat$lower[b_dat$b.x == "0"])`, `r sprintf("%1.2f", b_dat$upper[b_dat$b.x == "0"])`]), relative to a block 8 mean of `r sprintf("%1.2f", b_dat$p[b_dat$b.x == "7"])` (95% CI[`r sprintf("%1.2f", b_dat$lower[b_dat$b.x == "7"])`, `r sprintf("%1.2f", b_dat$upper[b_dat$b.x == "7"])`]). The model showed that accuracy increased by block with an average log odds of = `r sprintf("%1.2f", acc_results$fixed["b","Estimate"])`, (95% CI[`r sprintf("%1.2f", acc_results$fixed["b","l-95% CI"])`, `r sprintf("%1.2f", acc_results$fixed["b","u-95% CI"])`, Fig \ref{fig:accfig}C). There was also the suggestion of a main effect of the drug intervention (mean log odds = `r sprintf("%1.2f", acc_results$fixed["drugplacebo","Estimate"])`, 95% CI[`r sprintf("%1.3f", acc_results$fixed["drugplacebo","l-95% CI"])`, `r sprintf("%1.2f", acc_results$fixed["drugplacebo","u-95% CI"])`, Fig \ref{fig:accfig}D), however, the impact of drug on accuracy is presumably better explained by the drug x mindfulness interaction. 

```{r, accfig, out.width='70%', fig.cap='The influence of dopamine and mindfulness on accuracy. A) Accuracy (acc) data by block and drug. Circles reflect observed average accuracy, dotted lines reflect the fit of the winning model. B) The association between trait mindfulness (x-axis) and the impact of drug on accuracy [DA-P]. The bottom row shows posterior densities (in log odds) estimated for C) the main effect of block (b), D) the main effect of DA, and E) the drug x mindfulness (m) interaction. DA = dopamine, P = placebo, d = density. Error bars reflect within-subject standard error of the mean [SE].'}

accfigpth <- '../../images/acc_fig.pdf'
knitr::include_graphics(accfigpth)
```

## Contextual accuracy (acc)

```{r, load_cacc_mod_comps, echo = FALSE, warning = FALSE, message=FALSE, results = FALSE}

load('../../data/derivatives/cacc_loo.Rda')
load('../../data/derivatives/cacc_mind_loo.Rda')
load('../../data/derivatives/cacc_mind_bis_comp.Rda')
load('../../data/derivatives/cacc_winplusmind/cacc_winplusmind.Rda')
cacc_results <- print(mnd, digits = 2)

```

### Model Selection
 
The model that best accounted for the experimental factors contained main fixed effects of block and drug, and random effects for block x drug. Although this model was only closely preferred to the next most complex model that contained a block x drug interaction (ELPD diff = `r sprintf("%1.2f", cacc_comp["fxbdrgint_bdrgsubrfx", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", cacc_comp["fxbdrgint_bdrgsubrfx", "elpd_diff"]/cacc_comp["fxbdrgint_bdrgsubrfx", "se_diff"])`), it was strongly preferred to all other models (min ELPD diff = `r sprintf("%1.2f", cacc_comp["fxbdrg_bsubrfx", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", cacc_comp["fxbdrg_bsubrfx", "elpd_diff"]/cacc_comp["fxbdrg_bsubrfx", "se_diff"])`). Adding mindfulness scores improved the predictive accuracy of the model; the winning model contained an additional main effect of mindfulness (ELPD diff = `r sprintf("%1.2f", cacc_mind_comp["fxbdrg_rfxbdrg", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", cacc_mind_comp["fxbdrg_rfxbdrg", "elpd_diff"]/cacc_mind_comp["fxbdrg_rfxbdrg", "se_diff"])`). Adding BIS scores did not improve the predictive value of the model (ELPD diff = `r sprintf("%1.2f", cacc_mind_bis_comp["acc_mindwin_bis", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", cacc_mind_bis_comp["acc_mindwin_bis", "elpd_diff"]/cacc_mind_bis_comp["acc_mindwin_bis", "se_diff"])`). Note that although we draw inferences over parameters from the winning model, our inferences are the same as if we had used the more complex model that includes the BIS scores.

### Drug, and not mindfulness, impacts contextual accuracy

```{r, cacc_descriptives, echo = FALSE, warning = FALSE, message=FALSE, results = FALSE}
## Here I grab the summary stats saved in the plotting file
load("../../data/derivatives/cacc_descriptives.Rda")

overall_acc_by_drug <- Rmisc::summarySEwithin(data=sum_dat, measurevar="p",
                                              withinvars = "drug",
                                              idvar = "sub")
overall_acc_by_drug <- overall_acc_by_drug %>% mutate(lower = p-ci, upper = p+ci)

# summarise block 1 vs block 8
b_dat <- Rmisc::summarySEwithin(data=sum_dat, measurevar = "p",
                                withinvars="b.x",
                                idvar="sub")
b_dat <- b_dat %>% mutate(upper=p+ci, lower=p-ci)
```

Having established the best model to account for the data, we next determined the influence of DA and mindfulness on accuracy by making inference over the resulting model parameters (see Fig \ref{fig:caccfig}. DA reduced contextual accuracy; accuracy was on average `r sprintf("%1.2f", overall_acc_by_drug$p[overall_acc_by_drug$drug == "levodopa"])` (95% CI [`r sprintf("%1.2f", overall_acc_by_drug$lower[overall_acc_by_drug$drug == "levodopa"])`, `r sprintf("%1.2f", overall_acc_by_drug$upper[overall_acc_by_drug$drug == "levodopa"])`]) for the DA session, and `r sprintf("%1.2f", overall_acc_by_drug$p[overall_acc_by_drug$drug == "placebo"])` (95% CI [`r sprintf("%1.2f", overall_acc_by_drug$lower[overall_acc_by_drug$drug == "placebo"])`, `r sprintf("%1.2f", overall_acc_by_drug$upper[overall_acc_by_drug$drug == "placebo"])`]) for the placebo session. The log-odds of selecting a target door that was specific to the current context increased by a mean log odds of `r sprintf("%1.2f", cacc_results$fixed["drugplacebo","Estimate"])` (95% CI[`r sprintf("%1.2f", cacc_results$fixed["drugplacebo","l-95% CI"])`, `r sprintf("%1.2f", cacc_results$fixed["drugplacebo","u-95% CI"])`, Fig \ref{fig:caccfig}A&B) for the placebo session, relative to the DA session. 

Participants learned to make contextually accurate door selections over the course of the sessions; mean accuracy in block 1 was `r sprintf("%1.2f", b_dat$p[b_dat$b.x == "0"])` (95% CI[`r sprintf("%1.2f", b_dat$lower[b_dat$b.x == "0"])`, `r sprintf("%1.2f", b_dat$upper[b_dat$b.x == "0"])`]), relative to a block 8 mean of `r sprintf("%1.2f", b_dat$p[b_dat$b.x == "7"])` (95% CI[`r sprintf("%1.2f", b_dat$lower[b_dat$b.x == "7"])`, `r sprintf("%1.2f", b_dat$upper[b_dat$b.x == "7"])`]). The model showed that contextual accuracy increased by a mean log odds of `r sprintf("%1.2f", cacc_results$fixed["b","Estimate"])` (95% CI[`r sprintf("%1.2f", cacc_results$fixed["b","l-95% CI"])`, `r sprintf("%1.2f", cacc_results$fixed["b","u-95% CI"])`) over each block (Fig \ref{fig:caccfig}C). In contrast to the overall accuracy data, mindfulness did not have a reliable impact on contextual accuracy (mean log odds = `r sprintf("%1.2f", cacc_results$fixed["m","Estimate"])`, 95% CI[`r sprintf("%1.2f", cacc_results$fixed["m","l-95% CI"])`, `r sprintf("%1.2f", acc_results$fixed["m","u-95% CI"])`]). 

```{r, caccfig, out.width='70%', fig.cap='The influence of dopamine and mindfulness on contextual accuracy. A) Accuracy (acc) data by block and drug. Circles reflect observed average accuracy, dotted lines show the fit of the winning model. B) Estimated posterior density (in log odds) for the main effect of drug (DA vs P), D) same as in B, but for the main effect of block. DA = dopamine, P = placebo, b = block, d = density. Error bars reflect within-subject standard error of the mean [SE].'}

caccfigpth <- '../../images/cacc_fig.pdf'
knitr::include_graphics(caccfigpth)
```

#### Contextual Accuracy Control Analysis

```{r, cacc_control, echo = FALSE, warning = FALSE, message=FALSE, results = FALSE}

load('../../data/derivatives/sanity_check_contextual.Rda')

```

DA influences contextual accuracy, which indexes the likelihood of cc door selections, given the set of cc and oc door selections. As we exclude door selections for locations that never have a target behind them in either context (n) from the computation of contextual accuracy, it is important to verify that contextual accuracy scores do indeed reflect difficulty in selecting appropriately from the experimental set of task relevant behaviours (cc + oc), and that the current findings are not driven by another factor such as a general task learning deficit. To address this in an exploratory analysis, we reasoned that if contextual accuracy scores reflected a general deficit, then 'error' door selections (i.e. non-cc selections) should be drawn at random from the remaining doors (oc = 4 & n = 8). Therefore, when considering only oc and n door selections, a general deficit interpretation suggests that oc doors should be selected from this total set (oc + n) with $p$ = $\overline{.333}$, i.e. at chance. If contextual accuracy scores do tap a specific difficulty in selecting contextually relevant behaviours from the set of all task-relevant behaviours, then oc doors should instead be selected more than chance. To test this, we computed for each participant the probability of oc selections, given the set of oc and n ($p_{oc}$), and performed a one-sided t-test, against a null value of $p$ = .333. (Note that we opted to use an NHST approach as we had a point null hypothesis). The $p_{oc}$ data was unlikely under the null hypothesis (mean = `r sprintf("%1.2f", desc_stats_err$mu)`, 95% CI[`r sprintf("%1.2f", desc_stats_err$lower)`, `r sprintf("%1.2f", desc_stats_err$upper)`], $t$(`r sprintf("%.0f", tt$parameter)`) = `r sprintf("%1.2f", tt$statistic)`, $p$ = `r sprintf("%1.4f", tt$p.value)`. Therefore, the influence of DA on contextual accuracy cannot be fully explained by a general learning deficit. We return to this point in the discussion.

## Stereotypy of door selections

```{r, load_stereo_mod_comps, echo = FALSE, warning = FALSE, message=FALSE, results = FALSE}

load('../../data/derivatives/stereo_loo.Rda')
load('../../data/derivatives/stereo_mind_loo.Rda')
load('../../data/derivatives/stereo_mind_bis_loo.Rda')
load('../../data/derivatives/stereo_winplusmind_dmindint/stereo_winplusmind_dmindint.Rda')
stereo_results <- print(mndbd_dm, digits = 2)

```

### Model Selection
 
The model that best accounted for the experimental factors contained main fixed effects of block and drug, and random effects for block x drug. Although this model was only closely preferred to the next most complex model that contained a block x drug interaction (ELPD diff = `r sprintf("%1.2f", stereo_comp["fxbdrgint_bdrgsubrfx", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", stereo_comp["fxbdrgint_bdrgsubrfx", "elpd_diff"]/stereo_comp["fxbdrgint_bdrgsubrfx", "se_diff"])`), it was strongly preferred to all other models (min ELPD diff = `r sprintf("%1.2f", stereo_comp["fxbdrg_bsubrfx", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", stereo_comp["fxbdrg_bsubrfx", "elpd_diff"]/stereo_comp["fxbdrg_bsubrfx", "se_diff"])`). Adding mindfulness scores improved the predictive accuracy of the model; the winning model contained an additional main effect of mindfulness and a drug x mindfulness interaction (ELPD diff = `r sprintf("%1.2f", stereo_mind_loo["fxbdrg_rfxbdrg", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", stereo_mind_loo["fxbdrg_rfxbdrg", "elpd_diff"]/stereo_mind_loo["fxbdrg_rfxbdrg", "se_diff"])`). Adding BIS scores did not improve the predictive accuracy of the model (ELPD diff = `r sprintf("%1.2f", stereo_mind_bis_loo["mndbdbis_bm", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", stereo_mind_bis_loo["mndbdbis_bm", "elpd_diff"]/stereo_mind_bis_loo["mndbdbis_bm", "se_diff"])`). Note that although we draw inferences over parameters from the winning model, our inferences are the same as if we had used the more complex model that includes the BIS scores.

### The impact of drug and mindfulness on stereotypy

```{r, stereo_descriptives, echo = FALSE, warning = FALSE, message=FALSE, results = FALSE}
## Here I grab the summary stats saved in the plotting file
load("../../data/derivatives/stereo_descriptives.Rda")

# summarise mindfulness interaction
qs <- with(dm, quantile(m, c(0.25, 0.75)))
sum_dat$qs <- 0
sum_dat$qs[sum_dat$m.x < qs[1]] <- 1
sum_dat$qs[sum_dat$m.x > qs[2]] <- 2
sum_dat$qs <- as.factor(sum_dat$qs)

qs_sum <- Rmisc::summarySEwithin(data=sum_dat, measurevar="pred_v",
                                          withinvars=c("drug", "qs"),
                                          idvar="sub")
qs_sum <- qs_sum %>% mutate(lower=pred_v-ci, upper=pred_v+ci)

# summarise block 1 vs block 8
#b_dat <- Rmisc::summarySEwithin(data=sum_dat, measurevar = "p",
#                                withinvars="b.x",
#                                idvar="sub")
#b_dat <- b_dat %>% mutate(upper=p+ci, lower=p-ci)
stereo_dat_4_correlation_w_acc <- sum_dat %>% group_by(sub) %>% summarise(mu_v = mean(v), m = m.x[1], qs = qs[1])
tmp <- sum_dat %>% group_by(sub, drug) %>% summarise(mu_v = mean(v)) %>%
                     group_by(sub) %>% summarise(delta_v = mu_v[drug == "levodopa"] -
                                                           mu_v[drug == "placebo"])
stereo_dat_4_correlation_w_acc <- inner_join(stereo_dat_4_correlation_w_acc, tmp)
```

In line with the notion that mindfulness and dopamine interact to impact the formation of stereotypical door selections, we observed a reliable drug x mindfulness interaction on stereotypy (mean $\beta$ = `r sprintf("%1.2f", stereo_results$fixed["drugplacebo:m","Estimate"])`, 95% CI[`r sprintf("%1.2f", stereo_results$fixed["drugplacebo:m","l-95% CI"])`, `r sprintf("%1.2f", stereo_results$fixed["drugplacebo:m","u-95% CI"])`, Fig \ref{fig:stereofig}). Mindfulness scores modulated the stereotypy difference between the DA and placebo sessions; for example, those scoring in the highest quartile showed mean log variance scores of `r sprintf("%1.2f", qs_sum$pred_v[qs_sum$drug == "levodopa" & qs_sum$qs == "2"])` (95%CI[`r sprintf("%1.2f", qs_sum$lower[qs_sum$drug == "levodopa" & qs_sum$qs == "2"])`, `r sprintf("%1.2f", qs_sum$upper[qs_sum$drug == "levodopa" & qs_sum$qs == "2"])`]) during the DA session, relative to mean log variance scores of `r sprintf("%1.2f", qs_sum$pred_v[qs_sum$drug == "placebo" & qs_sum$qs == "2"])` (95% CI[`r sprintf("%1.2f", qs_sum$lower[qs_sum$drug == "placebo" & qs_sum$qs == "2"])`, `r sprintf("%1.2f", qs_sum$upper[qs_sum$drug == "placebo" & qs_sum$qs == "2"])`]) during the placebo session. Individuals scoring low on mindfulness (lowest quartile) showed the opposite pattern (DA mean accuracy = `r sprintf("%1.2f", qs_sum$pred_v[qs_sum$drug == "levodopa" & qs_sum$qs == "1"])`, 95% CI[`r sprintf("%1.2f", qs_sum$lower[qs_sum$drug == "levodopa" & qs_sum$qs == "1"])`, `r sprintf("%1.2f", qs_sum$upper[qs_sum$drug == "levodopa" & qs_sum$qs == "1"])`], placebo mean accuracy = `r sprintf("%1.2f", qs_sum$p[qs_sum$drug == "placebo" & qs_sum$qs == "1"])`, 95%CI[`r sprintf("%1.2f", qs_sum$lower[qs_sum$drug == "placebo" & qs_sum$qs == "1"])`, `r sprintf("%1.2f", qs_sum$upper[qs_sum$drug == "placebo" & qs_sum$qs == "1"])`]). To visualise this interaction, we computed a mean variance change score between drug sessions for each participant ($\mu$ acc[DA - P]). Note that a positive score indicates that performance was better in the DA session relative to placebo. As can be seen in Fig \ref{fig:stereofig}B, there was a negative relationship between drug-induced variance changes and mindfulness. Thus the impact of DA on the establishment of stereotypical eye-movement sequences is dependent on the mindfulness state of the individual.

Participants developed more stereotypical patterns of door selections over the course of the experiment, as evidenced by a reliable increase in variance over blocks (mean increase per block: $\beta$ = `r sprintf("%1.2f", stereo_results$fixed["b","Estimate"])`, 95% CI[`r sprintf("%1.2f", stereo_results$fixed["b","l-95% CI"])`, `r sprintf("%1.2f", stereo_results$fixed["b","u-95% CI"])`, Fig \ref{fig:stereofig}C). In line with the interaction of drug x mindfulness reported above, the main effect of mindfulness suggested a negative relationship with variability (mindfulness mean $\beta$ = `r sprintf("%1.2f", stereo_results$fixed["m","Estimate"])`, 95% CI[`r sprintf("%1.2f", stereo_results$fixed["m","l-95% CI"])`, `r sprintf("%1.2f", stereo_results$fixed["m","u-95% CI"])`, Fig \ref{fig:stereofig}D). Overall, higher mindfulness scores predicted less stereotypy in door-selection patterns relative to low mindfulness scores.  

```{r, stereofig, out.width='70%', fig.cap='The influence of dopamine and mindfulness on door selection stereotypy. A) Accuracy (acc) data by block and drug. Circles reflect observed average variance (of the transition matrices), dotted lines show the fit of the winning model. B) The association between trait mindfulness (x-axis) and the impact of drug on variance [DA-P]. The bottom row shows posterior densities (in log odds) estimated for C) the main effect of block (b), D) the main effect of DA, and E) the drug x mindfulness (m) interaction. DA = dopamine, P = placebo, d = density. Error bars reflect within-subject standard error of the mean [SE].'}

stereofigpth <- '../../images/s_fig.pdf'
knitr::include_graphics(stereofigpth)
```

```{r, corvarwithacc, echo = FALSE, warning = FALSE, message=FALSE, results = FALSE}
# use this code chunk to correlate variance with overall accuracy

df <- inner_join(acc_dat_4_correlation_w_stereo, stereo_dat_4_correlation_w_acc, by = "sub")
cor_results <- with(df, cor.test(mu_acc, mu_v))
cor_df <- cor_results$parameter
cor_cor <- cor_results$estimate
cor_p <- cor_results$p.value
load('../../data/derivatives/stereo_winplusmindplusacc_dmindint/stereo_winplusmindplusacc_dmindint.Rda')
stereo_w_acc_mod_comp <- loo_compare(mndbd_dm, mndbdacc_dm)
stereo_update_results <-  print(mndbdacc_dm, digits = 2)

# Note to self: should code some DAGs so I can work out some potential underlying causal structures
```

#### On the relationship between accuracy and stereotypy

Accuracy and stereotypy showed opposing relationships with mindfulness and DA - higher mindfulness scores were associated with a beneficial influence of DA on accuracy, and lower levels of stereotypy, relative to placebo, whereas individuals scoring low on mindfulness showed a deleterious influence of DA on accuracy, coupled with increased stereotypy, relative to placebo. As accuracy and stereotypy are possibly, but not necessarily related (highly accurate individuals may show high variance over transition probabilities as they are selecting only the correct target doors, but also individuals may form inaccurate transition preferences), we next sought to ensure that the observed influences of DA and mindfulness was not being driven by the same information in the data, using exploratory analyses. First we reasoned that such a pattern of results could be observed if the measures of accuracy and stereotypy reflected a direct trade off; i.e. as accuracy goes up, stereotypy goes down. A correlation analysis ruled out this possibility. We computed mean accuracy and stereotypy scores for each participant, collapsing across all experimental factors, and found that accuracy and stereotypy were positively related ($r$(`r sprintf("%d", cor_df)`) = `r sprintf("%.2f", cor_cor)`, $p$ = `r sprintf("%1.2e", cor_p)`). Next, to rule out the contribution of accuracy to the stereotypy results, we added mean accuracy, computed for each block and drug condition, as a regressor to the winning model. Adding accuracy as a regressor both clearly improved the predictive accuracy of the model (ELPD diff = `r sprintf("%1.2f", stereo_w_acc_mod_comp["mndbd_dm", "elpd_diff"])`, ELPD:SE = `r sprintf("%1.2f", stereo_w_acc_mod_comp["mndbd_dm", "elpd_diff"]/stereo_w_acc_mod_comp["mndbd_dm","se_diff"])`), and served to increase certainty in the mindfulness x drug interaction. Specifically, the estimated influence of the interaction increased from $\beta$ = `r sprintf("%1.2f", stereo_results$fixed["drugplacebo:m","Estimate"])` to $\beta$ = `r sprintf("%1.2f", stereo_update_results$fixed["drugplacebo:m","Estimate"])` (95% CI[`r sprintf("%1.2f", stereo_update_results$fixed["drugplacebo:m","l-95% CI"])`, `r sprintf("%1.2f", stereo_update_results$fixed["drugplacebo:m","u-95% CI"])`]). Note that the pattern of remaining results were also consistent between the two models. Therefore, the data support the notion that mindfulness and DA interact to differently influence accuracy and stereotypy when participants perform task-relevant eye-movement sequences. 

## Blinding check

```{r, blind_check, echo = FALSE, warning = FALSE, message=FALSE, results = FALSE}

load("../../data/derivatives/manip_checks.Rda")
mood_win <- mood[1]/mood[3]

```

Next we checked if participants knew whether they had received Levodopa or placebo across the two sessions. Participants were asked to report at the end of each session whether they thought they had received Levodopa or placebo. Participant responses were coded as either correct for both sessions (cc: observed N = `r sprintf("%.0f", counts["cc"])`), correct for one session and incorrect for the other (ci: N = `r sprintf("%.0f", counts["ic"])`), or incorrect for both sessions (ii: N = `r sprintf("%.0f", counts["ii"])`). The probability of the observed guesses was not statistically unlikely given the null distribution of chance performance (the null hypothesis specified $p$= .25, .5, .25 for cc, ci, ii respectively,  $\chi^2$(`r length(counts)-1`, `r n`) = `r sprintf("%1.2f", test_statistic)`, $p$ =`r sprintf("%.2f", p_value)`). Note that we were unable to include all the participants in this analysis owing to missing data. Specifically, due to a miscommunication in the research team, the blinding check questions contained 'Don't know' as a possible response, for which we are unable to generate a null hypothesis. We therefore only include participants who made a guess using the Levodopa and placebo options across both sessions.

## Mood and Blood Pressure

We also sought to determine whether DA influenced physiological factors such as mood and BP. For mood, the winning model contained a main effect of time-point and no other fixed effects. This model was preferred relative to next best model, which contained an additional main effect of drug (BF = 3.76, ±2.14%) and was substantially preferred over the null random intercept model (BF = 514549 ±1.23%). 

Mean blood pressure was computed using the formula: Mean BVP = diastolic blood pressure (DBP) + 1/3 [systolic blood pressure (SBP) – DBP]. For mean BVP, the winning model contained main effects of both time-point and drug. This model was barely preferred to the next best model which contained a time-point x drug interaction (BF = 1.7 ±5.69%), but was strongly preferred to the random intercept model (BF = 5011975 ±3.76%). Overall, mean BVP was lower in the Levodopa session (mean = `r sprintf("2.1%f", bvp_drug$bvp[bvp_drug$drug == "levodopa"])`, 95% CI[`r sprintf("%2.1f", bvp_drug$lower[bvp_drug$drug == "levodopa"])`, `r sprintf("%2.1f", bvp_drug$upper[bvp_drug$drug == "levodopa"])`]), relative to placebo (mean = `r sprintf("%2.1f", bvp_drug$bvp[bvp_drug$drug == "placebo"])`, 95% CI[`r sprintf("%2.1f", bvp_drug$lower[bvp_drug$drug == "placebo"])`, `r sprintf("2.1%f", bvp_drug$upper[bvp_drug$drug == "placebo"])`]).

# Discussion

We investigated the impact of mindfulness and dopamine on the formation of task relevant behaviour sets, the ability to select from learned behaviours according to context, and the stereotypical nature of behaviour deployment. Participants used their eyes to open doors in a gaze-contingent display, and were offered the opportunity to learn that coloured contexts signalled that targets would appear behind some doors and not others. Manipulating dopamine levels in healthy participants influenced all three phenomena of interest. For overall accuracy and stereotypy, the impact of increased dopamine interacted with trait mindfulness. Higher trait mindfulness was associated with a beneficial influence of increased dopamine, with higher overall accuracy and a concomitant decrease in behavioural stereotypy. Lower trait mindfulness resulted in a deleterious impact of increased dopamine, with lower overall accuracy and higher stereotypy. In contrast, we detected an influence of dopamine, and not mindfulness, on contextual accuracy. Overall, increasing dopamine reduced contextual accuracy, and made individuals more likely to select task-relevant behaviours from the wrong context. These results support the hypothesis that dopamine function impacts the excitation of task-relevant behaviours according to the current context. The data also support the hypothesis that the extent to which we learn task-relevant behaviours, and become routine in their execution, depends at least in part on interaction between the systems that underpin mindfulness and dopamine function in the human brain.

- Mindfulness, dopamine and the accuracy/stereotypy trade-off
Mindfulness work - check Reuben and Heleen's stuff
https://www.sciencedirect.com/science/article/pii/S1697260023000170
https://direct.mit.edu/jocn/article/34/4/655/109216/Leveraging-Spiking-Deep-Neural-Networks-to
https://www.biorxiv.org/content/10.1101/2022.11.15.516581v1.abstract
https://www.sciencedirect.com/science/article/pii/S014976342100261X

Graybiel work
https://www.sciencedirect.com/science/article/pii/S0896627315006418
https://www.pnas.org/doi/abs/10.1073/pnas.1013470107
https://www.frontiersin.org/articles/10.3389/fnsys.2015.00185/full
Related
https://www.sciencedirect.com/science/article/pii/S0896627318306755
https://www.sciencedirect.com/science/article/pii/S0896627322000617
https://direct.mit.edu/jocn/article/34/7/1103/110007/Caught-in-the-ACTS-Defining-Abstract-Cognitive
https://direct.mit.edu/jocn/article/34/8/1307/111231/Hierarchical-Reinforcement-Learning-Sequential

- Contextual accuracy
Songbird work
https://www.sciencedirect.com/science/article/pii/S0306452214008720
https://www.sciencedirect.com/science/article/pii/S0959438820301173
https://academic.oup.com/ilarjournal/article/51/4/362/676057
https://www.sciencedirect.com/science/article/pii/S0959438821000131
https://www.sciencedirect.com/science/article/pii/S0149763421004759
https://www.biorxiv.org/content/10.1101/2022.09.09.507372v1.abstract
https://www.sciencedirect.com/science/article/pii/S2211124722003187

- What I think the mechanisms are that we have found, but what we need to disambiguate in future work
 - other - dopamine can improve when distraction is task-irrelevant - https://link.springer.com/article/10.1007/s00213-004-1899-2
 - no effect of mindfulness on attention - https://www.sciencedirect.com/science/article/pii/S0191886914001159?via%3Dihub

Limitations
- BVP - different, could it contribute to the results. It was unnoticeable to participants.
- potential relationship between accuracy/stereotypy
- power of the blinding test

wider speculations 
- relationship to keeping on track, goal relevant behaviour system
- relationship to clinical syndromes such as ADHD?
- mindulness interventions for staying on task/maintaining contextually relevant behaviours

Conclusions
